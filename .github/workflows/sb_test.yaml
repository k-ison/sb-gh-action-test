name: Test

on:
  pull_request_target:
    types:
      - opened

jobs:
  db-check:
    permissions: write-all
    runs-on: ubuntu-latest

    steps:
      - name: Checkout actions
        uses: actions/checkout@v3

      - name: Supabase setup
        uses: supabase/setup-cli@v1
        with:
          version: latest

      - name: Login
        run: supabase login --no-browser --token sbp_4ff1255053f5070b593c6582be586c2f3f865bd2
      
      - name: Link
        run: supabase link --project-ref ucmhfwjiqefnulgkkotk

      - name: Reset
        run: supabase db reset --linked
